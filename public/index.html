<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中二病也要打手枪！</title>

    <script type="importmap">
    {
      "imports": {
        "js-yaml": "../node_modules/js-yaml/dist/js-yaml.mjs",
        "@sfirew/minecraft-motd-parser": "../node_modules/@sfirew/minecraft-motd-parser/dist/index.mjs"
      }
    }
    </script>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="changeBoxCSS.css">
    <link rel="stylesheet" href="select.css">
    <script type="module" src="editLogic.js"></script>
    <script type="module" src="script.js"></script>
    <script type="module" src="Utils.js"></script>
</head>

<body>
    <div class="headpng">
        <img class="headmiku" src="miku.jpg" alt="我喜欢你 ❤">
    </div>

    <div style="flex-direction: row; display: flex; justify-content: center; align-items: stretch; width: 100%; max-width: 90%;">
      
      <div class="card" style="flex: 4; width: auto; margin-right: 10px; display: flex; flex-direction: column;">
          <h1>Trm菜单元素可视化</h1>
          <p>📝在这里输入配置文件，这里是针对菜单的兑换物品特化喔</p>
          <textarea id="trmText" name="trmElem" placeholder="在这里输入配置文件..." class="TrmInput"></textarea>

          <button id="myButton" class="action-btn">点我进行处理 ✨</button>
      </div>

      <div class="card" id="outputCard" hidden="true" style="flex: 1; width: auto; margin-left: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
          <img id="pixelIcon" class="pixel-icon" style="cursor: pointer; margin-bottom: 20px;" src="https://assets.mcasset.cloud/1.20.1/assets/minecraft/textures/item/barrier.png" alt="物品图标" />
          
          <div class="outputContainer" style="padding: 15px; width: 100%; box-sizing: border-box;">
            <button class="nav-btn prev" id="prevBtn" style="font-size: 30px;">❮</button>
            <div id="outputBox" style="text-align: center; width: 100%; margin: 10px 0;" >
              <div id="errMessage" hidden></div>
              <div class="click-tip">点击图标<br>查看详情</div>
            </div>
            <button class="nav-btn next" id="nextBtn" style="font-size: 30px;">❯</button>
          </div>
      </div>
    </div>

    <div id="advancedPanel" hidden style="flex-direction: column; display: flex; justify-content: flex-start; align-items: center; width: 100%; margin-top: 20px; max-width: 80%;">
        
        <div id="changeBoxA" class="card" style="display: flex; flex-direction: column; width: 95%;">
            <h2>🛠️ 修改 </h2>
            
            <h3 style="display:block; margin: 20px; color:#ffffff; text-align: center;" id="currentItemName">什么都没有哟？</h3>
            
            <div class="control-row">
                <button id="delPropBtn" class="action-btn small-btn delete-btn" title="删除当前选中的条件">🗑️</button>
                
                <div style="flex: 1; margin: 0 10px; display: flex; flex-direction: column; min-width: 0;">
                    <div class="select-modern-wrapper">
                        <select id="propSelect" class="select-modern">
                        </select>
                    </div>
                    <div id="propTypeDisplay" class="prop-type-label">Type: Unknown</div>
                </div>

                <button id="savePropBtn" class="action-btn small-btn save-btn" title="保存修改回对象">💾</button>
            </div>
            
            <div id="conditionSelectWrapper" class="select-modern-wrapper" hidden style="margin-top: 10px; width: 100%;">
                <select id="conditionSelect" class="select-modern" style="width: 100%;">
                </select>
            </div>

            <div id="detailEditor" class="editor-box">
                <p id="emptyDetailTip" style="margin: 0; color: #aaa;">未解析到材料需求</p>
                
                <div id="detailForm" hidden>
                    <div class="editor-field">
                        <label>类型 (Type)</label>
                        <select id="editType" class="editor-select"></select>
                    </div>
                    <div class="editor-field">
                        <label>材料名称 (Name)</label>
                        <input id="editName" class="editor-input">
                    </div>
                    <div>
                        <label>材料键名 (Key)</label>
                        <input id="editKey" class="editor-input">
                    </div>
                     <div class="editor-field">
                        <label>条件 (Amount/Value)</label>
                        <input id="editAmount" class="editor-input" type="number">
                    </div>
                    <div class="editor-field">
                        <label>原始逻辑 (Logic)</label>
                        <input id="editLogic" class="editor-input" readonly style="font-size: 10px; opacity: 0.7;">
                    </div>
                </div>
            </div>

            <div style="margin-top: auto; padding-top: 20px;">
              <button id="plusCondition" class="action-btn" style="background-color: #fda085; width: 100%;">➕ 添加新条件</button>
            </div>
        </div>

        <div id="changeBoxB" class="card" style="width: 95%;">
            <h2>🛠️ 结果导出 </h2>
            <p>严格缩进的 YAML 结果</p>
            <textarea id="yamlOutput" class="TrmInput" style="height: 250px; font-family: 'JetBrains Mono', monospace;" readonly placeholder="等待生成..."></textarea>
        </div>

    </div>
    <div class="footer">
        &copy; 2025 中二病也要打手枪！
    </div>
    
    <div id="detailOverlay" hidden>
        <div class="detail-content card">
            <h3 style="margin-bottom: 20px; color: #bbb;">物品详情预览</h3>
            <div id="itemName" style="text-align: center; font-size: 1.5em; margin-bottom: 15px;"></div>
            <div class="lore-scroll-container">
                <div id="itemLore" style="white-space: pre-wrap; text-align: left;"></div>
            </div>
            <p style="margin-top: 20px; font-size: 12px; color: #aaa;">(再次点击任意空白处关闭喵)</p>
        </div>
    </div>

</body>
</html>